"use strict";(self.webpackChunkmantis_free_react_admin_template=self.webpackChunkmantis_free_react_admin_template||[]).push([[431],{13431:function(e,t,r){r.r(t),r.d(t,{default:function(){return _}});var n=r(82937),o=r(42669),s=r(34207),a=r(26862),i=r(75958),u=r(10054),c=r(40737),l=r(46417),d=function(e){var t=e.color,r=e.title,s=e.count,a=e.symbol,d=e.percentage,m=e.isLoss;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.ZP,{container:!0,alignItems:"center",sx:{width:"100%"},children:[(0,l.jsx)(n.ZP,{item:!0,xs:d?6:12,textAlign:d?"right":"center",children:(0,l.jsxs)(o.Z,{variant:"h5",children:[a&&"CURRENCY"===a&&"$",s,a&&"PERCENTAGE"===a&&"%"]})}),d&&(0,l.jsx)(n.ZP,{item:!0,xs:6,textAlign:"left",children:(0,l.jsx)(i.Z,{variant:"combined",color:t,style:{backgroundColor:"transparent",color:"#000",fontSize:"0.75rem"},icon:(0,l.jsxs)(l.Fragment,{children:[!m&&(0,l.jsx)(u.Z,{style:{fontSize:"0.5rem",color:"inherit"}}),m&&(0,l.jsx)(c.Z,{style:{fontSize:"0.5rem",color:"inherit"}})]}),label:"".concat(d,"%"),sx:{ml:.5,pl:.5},size:"small"})})]}),(0,l.jsx)(n.ZP,{item:!0,xs:12,textAlign:"center",children:(0,l.jsx)(o.Z,{variant:"h6",color:"textSecondary",style:{fontSize:"0.75rem"},children:r})})]})};d.defaultProps={color:"primary"};var m=d,g=r(5845),v=r.n(g),p=r(97548),x=r.n(p),f=r(1413),h=r(42982),y=r(70885),Z=r(47313),C=r(74165),w=r(15861),R=r(13997),j=r.n(R),b=function(){var e=(0,w.Z)((0,C.Z)().mark((function e(t,r){return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j().parse(t,{header:!0,download:!0,skipEmptyLines:!0,complete:r});case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),P=r(70816),D=r.n(P),O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],S=function(e){var t=parseInt(e),r=Math.floor((""+t).length/3),n=parseFloat((0!==r?e/Math.pow(1e3,r):t).toPrecision(2));return console.log(n),n%1!==0&&(n=n.toFixed(1)),console.log("type",Number.isInteger(e)),Number.isInteger(e)?n+["","k","M","G","T","P","E"][r]:e.toFixed(2)};var _=function(){var e,t=function(){var e=(0,Z.useState)(!0),t=(0,y.Z)(e,2),r=t[0],n=t[1],o=(0,Z.useState)([]),s=(0,y.Z)(o,2),a=s[0],i=s[1],u=(0,Z.useState)({isLoading:!0,totalRevenue:0,generalTotalOrders:0,newCustomers:0,percentageNewCustomersRevenue:0}),c=(0,y.Z)(u,2),l=c[0],d=c[1],m=(0,Z.useState)({isLoading:!0,avgRevenueDay:0,avgOrdersDay:0,avgItemsPerOrder:0,avgOrderValue:0,avgNewCustomersPerDay:0}),g=(0,y.Z)(m,2),v=g[0],p=g[1],x=(0,Z.useState)({isLoading:!0,existingCustomerRevenue:[],newCustomerRevenue:[],totalOrders:[],newCustomerOrders:[]}),C=(0,y.Z)(x,2),w=C[0],R=C[1],j=(0,Z.useState)({isLoading:!0,totalRevenueBySource:[],revenueBySourcePercentage:[[],["","",[]]]}),P=(0,y.Z)(j,2),_=P[0],L=P[1],I=(0,Z.useState)({isLoading:!0,totalRevenueByCountry:[["",0]]}),N=(0,y.Z)(I,2),F=N[0],B=N[1],A=l.totalRevenue,E=l.generalTotalOrders,M=l.newCustomers,k=l.percentageNewCustomersRevenue,T=v.avgRevenueDay,Y=v.avgOrdersDay,V=v.avgItemsPerOrder,z=v.avgOrderValue,G=v.avgNewCustomersPerDay,$=w.existingCustomerRevenue,U=w.newCustomerRevenue,J=w.totalOrders,q=w.newCustomerOrders,H=_.totalRevenueBySource,K=_.revenueBySourcePercentage,W=F.totalRevenueByCountry;(0,Z.useEffect)((function(){b("/revenue-dashboard/revenue-by-date.csv",Q)}),[]),(0,Z.useEffect)((function(){if(a.length){var e=(0,h.Z)(new Set(a.map((function(e){return e.order_date})))),t=(0,h.Z)(new Set(a.map((function(e){return e.order_revenue_source})))),r=(0,h.Z)(new Set(a.map((function(e){return e.order_country}))));ee(),te(e),re(t),ne(r)}}),[a]),(0,Z.useEffect)((function(){console.log(l.isLoading,v.isLoading,w.isLoading,_.isLoading),l.isLoading||v.isLoading||w.isLoading||_.isLoading||F.isLoading||(n(!1),console.log(W))}),[l.isLoading,v.isLoading,w.isLoading,_.isLoading,F.isLoading]);var Q=function(e){var t=e.data.map((function(e){var t=D()(e.order_date,["M/D/YY","DD/MM/YYYY"]).valueOf();return(0,f.Z)((0,f.Z)({},e),{},{order_date:t})}));t=t.sort((function(e,t){return e.order_date-t.order_date})),t=X(t),i(t)},X=function(e){var t=e[e.length-1].order_date,r=new Date(t);return r.setDate(r.getDate()-30),e.filter((function(e){return new Date(e.order_date)>r}))},ee=function(){var e=a.reduce((function(e,t){return e+Math.floor(t.order_revenue)}),0),t=a.reduce((function(e,t){return e+parseInt(t.num_orders)}),0),r=a.reduce((function(e,t){return"New"===t.customer_type?e+1:e}),0),n=a.reduce((function(e,t){return"New"===t.customer_type?e+parseFloat(t.order_revenue):e}),0),o=a.reduce((function(e,t){return e+parseInt(t.item_quantity)}),0),s=o/a.length,i=parseInt(e/30),u=parseInt(t/30),c=e/o,m=parseInt(r/30);d((0,f.Z)((0,f.Z)({},l),{},{isLoading:!1,totalRevenue:S(e),generalTotalOrders:S(t),newCustomers:S(r),percentageNewCustomersRevenue:S(parseFloat(n/e*100))})),p((0,f.Z)((0,f.Z)({},v),{},{isLoading:!1,avgRevenueDay:S(i),avgOrdersDay:u,avgItemsPerOrder:S(s),avgOrderValue:S(c),avgNewCustomersPerDay:m}))},te=function(e){var t=[],r=[],n=[],o=[],s=a.filter((function(e){return"New"===e.customer_type})),i=a.filter((function(e){return"Existing"===e.customer_type}));e.map((function(e){var u=a.filter((function(t){return e===t.order_date})),c=s.filter((function(t){return e===t.order_date})),l=i.filter((function(t){return e===t.order_date})),d=c.reduce((function(e,t){return e+parseFloat(t.order_revenue)}),0),m=l.reduce((function(e,t){return e+parseFloat(t.order_revenue)}),0),g=u.reduce((function(e,t){return e+parseInt(t.num_orders)}),0),v=c.reduce((function(e,t){return e+parseInt(t.num_orders)}),0);t.push([e,parseInt(d)]),r.push([e,parseInt(m)]),o.push([e,parseInt(g)]),n.push([e,parseInt(v)])})),R((0,f.Z)((0,f.Z)({},w),{},{isLoading:!1,existingCustomerRevenue:r,newCustomerRevenue:t,totalOrders:o,newCustomerOrders:n}))},re=function(e){var t=new Date(a[a.length-1].order_date),r=[a[a.length-1].order_date,t.setDate(t.getDate()-7),t.setDate(t.getDate()-7),t.setDate(t.getDate()-7),t.setDate(t.getDate()-7)].reverse(),n=[],o=[];e.map((function(e){var t=null,s=a.filter((function(t){return e===t.order_revenue_source})),i=(0,h.Z)(r.map((function(e,n){var o=new Date(e);return 0!==n&&(t=new Date(r[n-1])),s.reduce((function(e,r){var n=new Date(r.order_date);return t?n>t&&n<=o?e+parseInt(r.order_revenue):e:n<=o?e+parseInt(r.order_revenue):e}),0)}))),u=s.reduce((function(e,t){return e+parseFloat(t.order_revenue)}),0);o.push([e,i]),n.push([e,parseInt(u)])})),L((0,f.Z)((0,f.Z)({},_),{},{isLoading:!1,totalRevenueBySource:n.sort((function(e,t){return t[1]-e[1]})),revenueBySourcePercentage:[r.map((function(e){return"".concat(O[new Date(e).getMonth()]," ").concat(new Date(e).getDate())})),o.sort((function(e,t){return e[1].reduce((function(e,t){return e+t}))-t[1].reduce((function(e,t){return e+t}))}))]}))},ne=function(e){var t=[],r=a.reduce((function(e,t){return e+parseFloat(t.order_revenue)}),0);e.map((function(e){var n=a.filter((function(t){return e===t.order_country})).reduce((function(e,t){return e+parseFloat(t.order_revenue)}),0);t.push([e,parseInt(n/r*100),n])})),B((0,f.Z)((0,f.Z)({},_),{},{isLoading:!1,totalRevenueByCountry:t}))};return{states:{isLoading:r,totalRevenue:A,generalTotalOrders:E,newCustomers:M,percentageNewCustomersRevenue:k,avgRevenueDay:T,avgOrdersDay:Y,avgItemsPerOrder:V,avgOrderValue:z,avgNewCustomersPerDay:G,existingCustomerRevenue:$,newCustomerRevenue:U,totalOrders:J,newCustomerOrders:q,totalRevenueBySource:H,revenueBySourcePercentage:K,totalRevenueByCountry:W}}}(),r=t.states,i=r.isLoading,u=r.totalRevenue,c=r.generalTotalOrders,d=r.newCustomers,g=r.percentageNewCustomersRevenue,p=r.avgRevenueDay,C=r.avgOrdersDay,w=r.avgItemsPerOrder,R=r.avgOrderValue,j=r.avgNewCustomersPerDay,P=r.existingCustomerRevenue,_=r.newCustomerRevenue,L=r.totalOrders,I=r.newCustomerOrders,N=r.totalRevenueBySource,F=r.revenueBySourcePercentage,B=r.totalRevenueByCountry,A={chart:{type:"column"},title:{text:"Revenue by Date",align:"left"},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%e %b"}},yAxis:[{title:{text:"Existing Customer Revenue"},stackLabels:{enabled:!0,formatter:function(){return"$"+v().numberFormat(this.total,0,",",".")}}},{labels:{formatter:function(){var e=this.value,t=parseFloat(e/1e3);return"".concat(t,"K")}},title:{text:"Total Orders"},opposite:!0,max:2500}],tooltip:{formatter:function(){return'<span style="color:'.concat(this.color,'">\u25cf</span> ').concat(this.series.name,": <b>$").concat(v().numberFormat(this.y,0,",","."),'</b><br/><span style="color:').concat(this.color,'">\u25cf</span> Date: <b>').concat(new Date(this.x).getDate()+"/"+(new Date(this.x).getMonth()+1),"</b><br/>")}},plotOptions:{column:{stacking:"normal"},spline:{marker:{enabled:!1}}},series:[{name:"Existing Customer Revenue",data:(e={existingCustomerRevenue:P,newCustomerRevenue:_,totalOrders:L,newCustomerOrders:I}).existingCustomerRevenue,yAxis:0},{name:"New Customer Revenue",data:e.newCustomerRevenue,yAxis:0},{type:"spline",name:"Total Orders",data:e.totalOrders,yAxis:1},{type:"spline",name:"New Customer Orders",data:e.newCustomerOrders,yAxis:1}]},E=function(e){var t=e.revenueBySourcePercentage;return{chart:{type:"column"},title:{text:"Revenue by Source",align:"left"},xAxis:{categories:t[0]},yAxis:{min:0,title:{text:"Percentage"},labels:{formatter:function(){var e=this.value,t=Math.floor((""+e).length/3),r=parseFloat((0!==t?e/Math.pow(1e3,t):e).toPrecision(2));return r%1!==0&&(r=r.toFixed(1)),r+["","k","M","G","T","P","E"][t]}}},legend:{reversed:!0},tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.percentage:.0f}%)<br/>',shared:!0},plotOptions:{column:{stacking:"percent"}},series:(0,h.Z)(t[1].map((function(e){return{name:e[0],data:e[1]}})))}}({revenueBySourcePercentage:F}),M=function(e){var t=e.totalRevenueBySource;return{chart:{type:"column",inverted:!0},title:{text:"Revenue by Source",align:"left"},xAxis:{categories:t.map((function(e){return e[0]}))},yAxis:{labels:{formatter:function(){var e=this.value,t=Math.floor((""+e).length/3),r=parseFloat((0!==t?e/Math.pow(1e3,t):e).toPrecision(2));return r%1!==0&&(r=r.toFixed(1)),r+["","k","M","G","T","P","E"][t]}}},tooltip:{formatter:function(){return'<span style="color:'.concat(this.color,'">\u25cf</span> ').concat(this.series.name,": <b>$").concat(v().numberFormat(this.y,0,",","."),"</b><br/>")}},series:[{name:"Revenue by Source",data:t.map((function(e){return e[1]})),dataLabels:{enabled:!1}}]}}({totalRevenueBySource:N}),k={chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"Revenue by Country",align:"left"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b><br/> Revenue on the last 30 days: <b>$ {point.tooltip.revenue}</b>"},accessibility:{point:{valueSuffix:"%"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",showInLegend:!1,dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %"}},ignoreHiddenPoint:!1},series:[{name:"Revenue by Country",colorByPoint:!0,data:{totalRevenueByCountry:B}.totalRevenueByCountry.sort((function(e,t){return e[1]-t[1]})).map((function(e,t){var r={name:e[0],y:e[1],tooltip:{revenue:v().numberFormat(e[2],0,",",".")}};return 0===t?(0,f.Z)((0,f.Z)({},r),{},{sliced:!0,selected:!0}):r}))}]};return(0,l.jsxs)("section",{children:[(0,l.jsx)(n.ZP,{container:!0,children:(0,l.jsx)(n.ZP,{item:!0,xs:12,sx:{mb:2.25},children:(0,l.jsx)(o.Z,{variant:"h5",children:"Dashboard"})})}),i?(0,l.jsx)(n.ZP,{item:!0,xs:12,sx:{margin:"auto"},children:(0,l.jsx)(a.Z,{children:(0,l.jsx)(n.ZP,{container:!0,justifyContent:"center",children:(0,l.jsx)(s.Z,{})})})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.ZP,{container:!0,rowSpacing:4.5,columnSpacing:1,sx:{mb:1},children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:6,alignItems:"stretch",children:(0,l.jsx)(a.Z,{children:(0,l.jsxs)(n.ZP,{container:!0,justifyContent:"space-between",children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:4,lg:3,sx:{"@media screen and (min-width: 600px)":{justifyContent:"center"}},children:(0,l.jsx)(m,{title:"Total Revenue",count:u,symbol:"CURRENCY"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,l.jsx)(m,{title:"Total Orders",count:c})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,l.jsx)(m,{title:"New Customers",count:d})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,l.jsx)(m,{title:"% New Customers Revenue",count:g,symbol:"PERCENTAGE"})})]})})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:6,children:(0,l.jsx)(a.Z,{children:(0,l.jsxs)(n.ZP,{container:!0,justifyContent:"space-between",children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:6,lg:2.4,children:(0,l.jsx)(m,{title:"Avg Revenue/Day",count:p,symbol:"CURRENCY"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:6,lg:2.4,children:(0,l.jsx)(m,{title:"Avg Orders/Day",count:C})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:6,lg:2.4,children:(0,l.jsx)(m,{title:"Avg Items/Order",count:w})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:6,lg:2.4,children:(0,l.jsx)(m,{title:"Avg Order Value",count:R,symbol:"CURRENCY"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,md:6,lg:2.4,children:(0,l.jsx)(m,{title:"Avg New Customers/Day",count:j})})]})})})]}),(0,l.jsx)(n.ZP,{container:!0,rowSpacing:4.5,columnSpacing:1,sx:{mb:1},children:(0,l.jsx)(n.ZP,{item:!0,xs:12,justifyContent:"center",children:(0,l.jsx)(a.Z,{children:(0,l.jsx)(x(),{highcharts:v(),options:A})})})}),(0,l.jsxs)(n.ZP,{container:!0,rowSpacing:4.5,columnSpacing:1,sx:{mb:1},children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,children:(0,l.jsx)(a.Z,{children:(0,l.jsx)(x(),{highcharts:v(),options:E})})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,sm:6,children:(0,l.jsx)(a.Z,{children:(0,l.jsx)(x(),{highcharts:v(),options:M})})})]}),(0,l.jsx)(n.ZP,{container:!0,rowSpacing:4.5,columnSpacing:1,children:(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(a.Z,{children:(0,l.jsx)(x(),{highcharts:v(),options:k})})})})]})]})}}}]);